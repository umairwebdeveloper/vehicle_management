{% for reply in replies %}
<div class="mb-3 border rounded p-2">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <strong>{{ reply.author.username }}</strong>
            {% if reply.author == request.user %}
            <span class="badge bg-info ms-1">You</span>
            {% endif %}
            <small class="text-muted ms-2">{{ reply.created|date:"M d, Y H:i" }}</small>
        </div>

        {% if reply.author == request.user %}
        <div>
            <button class="btn btn-link btn-sm reply-edit-btn" data-reply-id="{{ reply.pk }}" data-reply-body="{{ reply.body|escapejs }}">Edit</button>
            <button class="btn btn-link btn-sm text-danger reply-delete-btn" data-reply-id="{{ reply.pk }}">Delete</button>
        </div>
        {% endif %}
    </div>

    <p>{{ reply.body }}</p>

    <button class="btn btn-link btn-sm reply-to-btn" data-reply-id="{{ reply.pk }}" data-reply-body="{{ reply.body|escapejs }}">Reply</button>

    {% if reply.children.all %}
    <div class="ms-4 border-start ps-3 mt-2">{% include "forum/_reply_item.html" with replies=reply.children.all %}</div>
    {% endif %}
</div>
{% endfor %}
